!function(){"use strict";const e=new class{constructor(e){this.gesturesBridge=e}onTap(e){const t={x:(e.clientX-visualViewport.offsetLeft)*visualViewport.scale,y:(e.clientY-visualViewport.offsetTop)*visualViewport.scale},n=JSON.stringify(t);this.gesturesBridge.onTap(n)}onLinkActivated(e,t){this.gesturesBridge.onLinkActivated(e,t)}}(window.gestures);new class{constructor(e,t){this.window=e,this.listener=t,document.addEventListener("click",(e=>{this.onClick(e)}),!1)}onClick(e){if(e.defaultPrevented)return;const t=this.window.getSelection();if(t&&"Range"==t.type)return;let n;n=e.target instanceof HTMLElement?this.nearestInteractiveElement(e.target):null,n?n instanceof HTMLAnchorElement&&this.listener.onLinkActivated(n.href,n.outerHTML):this.listener.onTap(e),e.stopPropagation(),e.preventDefault()}nearestInteractiveElement(e){return null==e?null:-1!=["a","audio","button","canvas","details","input","label","option","select","submit","textarea","video"].indexOf(e.nodeName.toLowerCase())||e.hasAttribute("contenteditable")&&"false"!=e.getAttribute("contenteditable").toLowerCase()?e:e.parentElement?this.nearestInteractiveElement(e.parentElement):null}}(window,e),Window.prototype.readiumcss=new class{constructor(e){this.document=e}setProperties(e){for(const[t,n]of e)this.setProperty(t,n)}setProperty(e,t){null===t||""===t?this.removeProperty(e):document.documentElement.style.setProperty(e,t,"important")}removeProperty(e){document.documentElement.style.removeProperty(e)}}(window.document),window.documentState.onScriptsLoaded(),window.addEventListener("load",(e=>{let t=!1;new ResizeObserver((()=>{requestAnimationFrame((()=>{if(function(e){const t="readium-virtual-page";let n=e.document.getElementById(t);if(2!==function(e){return parseInt(e.getComputedStyle(e.document.documentElement).getPropertyValue("column-count"))}(e))return!!n&&(n.remove(),!0);{const o=e.document.scrollingElement.scrollWidth/e.innerWidth;return!!(Math.round(2*o)/2%1>.1)&&(n?n.remove():(n=e.document.createElement("div"),n.setAttribute("id",t),n.dataset.readium="true",n.style.breakBefore="column",n.innerHTML="&#8203;",e.document.body.appendChild(n)),!0)}}(window))return;const e=window.document.scrollingElement;!t&&(null==e||e.scrollHeight>0||e.scrollWidth>0)?(window.documentState.onDocumentLoadedAndSized(),t=!0):window.documentState.onDocumentResized()}))})).observe(document.body)}))}();
//# sourceMappingURL=reflowable-injectable-script.js.map